import r2pipe
import json

class GetBianryInfo:
    binary_name = None
    r2 = None
    
    def __init__(self, binary_name) -> None:
        binary_name = binary_name
        self.r2 = r2pipe.open(binary_name)
        self.r2.cmd("aaa")
        
    def get_function(self):
        return self.r2.cmd("afl | awk '{ print $4 }'")
    
    def get_import(self):
        return self.r2.cmd("ii | awk '{ print $5 }'")
    
    def get_export(self):
        return self.r2.cmd("iE | awk '{ print $7 }'")
    
    def get_string(self):
        return self.r2.cmd("iz | awk '{ print $8 }' | sed -n '6,20p'")
    
    def get_sessions(self):
        return self.r2.cmd("iS | awk '{ print $8 }' | sed -n '6,20p'")
    