<!DOCTYPE html>
<!-- saved from url=(0045)https://www.cnblogs.com/zjlbk/p/11398130.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin-when-crossorigin">
    <meta name="description" content="/date&amp;#160;航班信息文件/register&amp;#160;用户注册信息文件/user&amp;#160;用户购票信息文件 server head client">
    <meta property="og:description" content="/date&amp;#160;航班信息文件/register&amp;#160;用户注册信息文件/user&amp;#160;用户购票信息文件 server head client">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>基于Linux购票服务器 - 柚子皮max - 博客园</title>
    <link id="favicon" rel="shortcut icon" href="https://common.cnblogs.com/favicon.svg" type="image/svg+xml">
    
    <link rel="stylesheet" href="./基于Linux购票服务器 - 柚子皮max - 博客园_files/blog-common.min.css">
    <link id="MainCss" rel="stylesheet" href="./基于Linux购票服务器 - 柚子皮max - 博客园_files/bundle-lessismoreright.min.css">
    <link type="text/css" rel="stylesheet" href="./基于Linux购票服务器 - 柚子皮max - 博客园_files/cnblogs.css">
    <link type="text/css" rel="stylesheet" href="./基于Linux购票服务器 - 柚子皮max - 博客园_files/custom.css">
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./基于Linux购票服务器 - 柚子皮max - 博客园_files/bundle-lessismoreright-mobile.min.css">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/zjlbk/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/zjlbk/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/zjlbk/wlwmanifest.xml">
    <script async="" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/analytics.js.下载"></script><script type="text/javascript" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/encoder.js.下载"></script><script>
        var currentBlogId = 525257;
        var currentBlogApp = 'zjlbk';
        var cb_enable_mathjax = false;
        var isLogined = false;
        var isBlogOwner = false;
        var skinName = 'LessIsMoreRight';
        var visitorUserId = '';
        var hasCustomScript = false;
        try {
            if (hasCustomScript && document.referrer && document.referrer.indexOf('baidu.com') >= 0) {
                Object.defineProperty(document, 'referrer', { value: '' });
                Object.defineProperty(Document.prototype, 'referrer', { get: function(){ return ''; } });
            }
        } catch(error) { }
    </script>
        <script>
            var currentPostDateAdded = '2019-08-23 09:34';
        </script>
    <script src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/jquery-2.2.0.min.js.下载"></script>
    <script src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/blog-common.min.js.下载"></script><style type="text/css">.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}</style>
    
    
    
    <script type="text/javascript">
        window.codeHighlightEngine = 1
        window.enableCodeLineNumber = false
    </script>
</head>
<body class="skin-lessismoreright no-navbar">
    <a name="top"></a>
    <div id="top_nav" class="navbar forpc navbar-custom">
        <nav id="nav_main" class="navbar-main">
            <ul id="nav_left" class="navbar-list navbar-left">
                <li class="navbar-branding"><a href="https://www.cnblogs.com/" title="开发者的网上家园"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/logo.svg" alt="博客园Logo"></a></li>
                <li><a href="https://www.cnblogs.com/" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;skin-navbar-sitehome&#39;)">首页</a></li>
                <li><a href="https://news.cnblogs.com/" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;skin-navbar-news&#39;)">新闻</a></li>
                <li><a href="https://q.cnblogs.com/" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;skin-navbar-q&#39;)">博问</a></li>
                <li><a id="nav_brandzone" href="https://brands.cnblogs.com/" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;skin-navbar-brands&#39;)">专区</a></li>
                <li><a href="https://ing.cnblogs.com/" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;skin-navbar-ing&#39;)">闪存</a></li>
                <li><a href="https://edu.cnblogs.com/" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;skin-navbar-edu&#39;)">班级</a></li>
            </ul>
            <ul id="nav_right" class="navbar-list navbar-right">
                <li>
                    <form id="zzk_search" class="navbar-search" action="https://zzk.cnblogs.com/s" method="get">
                        <input name="w" id="zzk_search_input" placeholder="代码改变世界" type="text" tabindex="3">
                        <button type="submit" id="zzk_search_button">
                            <img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/search.svg" alt="搜索">
                        </button>
                    </form>
                </li>
                <li id="navbar_login_status" class="navbar-list">
                    <a class="navbar-user-info navbar-blog" href="https://i.cnblogs.com/EditPosts.aspx?opt=1" alt="写随笔" title="写随笔" style="display: none;">
                        <img id="new_post_icon" class="navbar-icon" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/newpost.svg" alt="写随笔">
                    </a>
                    <a id="navblog-myblog-icon" class="navbar-user-info navbar-blog" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx" alt="我的博客" title="我的博客" style="display: none;">
                        <img id="myblog_icon" class="navbar-icon" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/myblog.svg" alt="我的博客">
                    </a>
                    <a class="navbar-user-info navbar-message navbar-icon-wrapper" href="https://msg.cnblogs.com/" alt="短消息" title="短消息" style="display: none;">
                        <img id="msg_icon" class="navbar-icon" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/message.svg" alt="短消息">
                        <span id="msg_count" style="display: none"></span>
                    </a>
                    <div id="user_info" class="navbar-user-info dropdown" style="display: none;">
                        <a class="dropdown-button" href="https://home.cnblogs.com/">
                            <img id="user_icon" class="navbar-avatar" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/avatar-default.svg" alt="用户头像">
                        </a>
                        <div class="dropdown-menu">
                            <a id="navblog-myblog-text" href="https://passport.cnblogs.com/GetBlogApplyStatus.aspx">我的博客</a>
                            <a href="https://home.cnblogs.com/">我的园子</a>
                            <a href="https://account.cnblogs.com/settings/account">账号设置</a>
                            <a href="javascript:void(0)" id="navbar_lite_mode_toggle" title="简洁模式会使用简洁款皮肤显示所有博客">
    简洁模式 <img id="navbar_lite_mode_on" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/lite-mode-check.svg" class="hide"><span id="navbar_lite_mode_spinner" class="hide">...</span>
</a>
                            <a href="javascript:void(0)" onclick="account.logout();">退出登录</a>
                        </div>
                    </div>
                    <a class="navbar-anonymous" href="https://account.cnblogs.com/signup/" style="display: inline;">注册</a>
                    <a class="navbar-anonymous" href="javascript:void(0);" onclick="account.login()" style="display: inline;">登录</a>
                </li>
            </ul>
        </nav>
    </div>

    
    <div id="home">
    <div id="header">
        <div id="blogTitle">
            <div class="title"><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/zjlbk/">柚子皮max</a>
</div>
<div class="subtitle"></div>

        </div>
        <div id="navigator">
            
<ul id="navList">
    <li id="nav_sitehome"><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>
</li>
    <li id="nav_myhome">
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/zjlbk/">
首页</a>
</li>
    <li id="nav_newpost">

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">
新随笔</a>
</li>
    <li id="nav_contact">
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/%E6%9F%9A%E5%AD%90%E7%9A%AEmax">
联系</a></li>
    <li id="nav_rss">
<a id="blog_nav_rss" class="menu" href="javascript:void(0)" data-rss="https://www.cnblogs.com/zjlbk/rss/">
订阅</a></li>
    <li id="nav_admin">
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
</li>
</ul>

            <div class="blogStats">
                
<span id="stats_post_count">随笔 - 49&nbsp;</span>
<span id="stats_article_count">文章 - 0&nbsp;</span>
<span id="stats_comment_count">评论 - 7&nbsp;</span>
<span id="stats_total_view_count">阅读 - 
<span title="总阅读数: 14516">
14516</span></span>
            </div>
        </div>
    </div>
    <div id="main">
        <div id="mainContent">
            <div class="forFlow">
                <div id="post_detail">
    <div id="topics">
        <div class="post">
            <h1 class="postTitle">
                
<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/zjlbk/p/11398130.html">
    <span>基于Linux购票服务器</span>
    



</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p><br>/date&nbsp;航班信息文件<br>/register&nbsp;用户注册信息文件<br>/user&nbsp;用户购票信息文件</p>
<p>server</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>#include <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">head.h</span><span style="color: rgba(128, 0, 0, 1)">"</span>


<span style="color: rgba(0, 0, 255, 1)">char</span> chars[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
</span><span style="color: rgba(0, 0, 255, 1)">char</span> sendbuf[<span style="color: rgba(128, 0, 128, 1)">1024</span><span style="color: rgba(0, 0, 0, 1)">];

</span><span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">用户名</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> passwd[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">密码</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> number[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">航班号</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> staddress[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">起点站</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> arraddress[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">终点站</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> date[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">班期</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> type[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">机型</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> stime[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">起飞时间</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> price[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">票价</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> aggregate[<span style="color: rgba(128, 0, 128, 1)">10</span>];<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">总金额</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span> list_head list;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">内核链表指针域</span>
<span style="color: rgba(0, 0, 0, 1)">};

</span><span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node_ip{
    </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> ip[<span style="color: rgba(128, 0, 128, 1)">50</span><span style="color: rgba(0, 0, 0, 1)">];
    pthread_t tid;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_head list;
};

</span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *head =<span style="color: rgba(0, 0, 0, 1)"> NULL;

</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">初始化内核链表头</span>
<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *init_list_head_ip(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *<span style="color: rgba(0, 0, 0, 1)">head)
{
    head </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node_ip));
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(head ==<span style="color: rgba(0, 0, 0, 1)">NULL)
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc head error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

    INIT_LIST_HEAD(</span>&amp;(head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));

    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> head;
}


</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">尾插数据</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> add_list_node_ip(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *head,<span style="color: rgba(0, 0, 255, 1)">int</span> sockfd,<span style="color: rgba(0, 0, 255, 1)">char</span> ip[<span style="color: rgba(128, 0, 128, 1)">50</span><span style="color: rgba(0, 0, 0, 1)">],pthread_t tid)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *Node =<span style="color: rgba(0, 0, 0, 1)"> NULL;

    Node </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node_ip));
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(Node ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

    Node</span>-&gt;connfd =<span style="color: rgba(0, 0, 0, 1)"> sockfd;
    strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">ip,ip);
    Node</span>-&gt;tid =<span style="color: rgba(0, 0, 0, 1)"> tid;

    list_add_tail(</span>&amp;(Node-&gt;list),&amp;(head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));

    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}


</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">线程退出删除对应链表</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> delete_list_node_num_ip(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *<span style="color: rgba(0, 0, 0, 1)">head,pthread_t tid)
{
    
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *q =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    list_for_each_entry_safe(p,q,</span>&amp;(head-&gt;<span style="color: rgba(0, 0, 0, 1)">list),list)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(p-&gt;tid ==<span style="color: rgba(0, 0, 0, 1)"> tid)
        {
            list_del(</span>&amp;(p-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
            </span><span style="color: rgba(0, 0, 255, 1)">free</span><span style="color: rgba(0, 0, 0, 1)">(p);
        }
    }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">根据提供的connfd查找线程是否存在,存在返回1，不存在返回0</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> find_list_node_num(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *q =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    list_for_each_entry_safe(p,q,</span>&amp;(head-&gt;<span style="color: rgba(0, 0, 0, 1)">list),list)
    {
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(p-&gt;connfd ==<span style="color: rgba(0, 0, 0, 1)"> connfd)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> p-&gt;<span style="color: rgba(0, 0, 0, 1)">connfd ;
        }
    }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}
</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">删除整条链表</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> delete_list_ip(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *<span style="color: rgba(0, 0, 0, 1)">head)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node_ip *q =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    list_for_each_entry_safe(p,q,</span>&amp;(head-&gt;<span style="color: rgba(0, 0, 0, 1)">list),list)
    {
        list_del(</span>&amp;(p-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
        </span><span style="color: rgba(0, 0, 255, 1)">free</span><span style="color: rgba(0, 0, 0, 1)">(p);
    }
    
    list_del(</span>&amp;(head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
    </span><span style="color: rgba(0, 0, 255, 1)">free</span><span style="color: rgba(0, 0, 0, 1)">(head);
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">获取数字字符</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> char_input(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    bzero(chars,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(chars));
    fd_set rset;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buf[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> *<span style="color: rgba(0, 0, 0, 1)">str;
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> maxfd = connfd &gt; STDIN_FILENO ?<span style="color: rgba(0, 0, 0, 1)"> connfd : STDIN_FILENO;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        FD_ZERO(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(connfd,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(STDIN_FILENO,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        </span><span style="color: rgba(0, 0, 255, 1)">select</span>(maxfd+<span style="color: rgba(128, 0, 128, 1)">1</span>,&amp;<span style="color: rgba(0, 0, 0, 1)">rset,NULL,NULL,NULL);

        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(FD_ISSET(STDIN_FILENO,&amp;<span style="color: rgba(0, 0, 0, 1)">rset))
        {
            bzero(chars,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(chars));
            fgets(chars,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(chars),stdin);
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(connfd != <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            bzero(buf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buf));
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(recv(connfd,buf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(buf),<span style="color: rgba(128, 0, 128, 1)">0</span>)&gt;<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
                str </span>= strtok(buf, <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            strcpy(chars,str);
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,chars);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;    
        }

    }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> ;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">申请链表头,返回链表头</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *init_list_head(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    _head </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node));
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(_head ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc head error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc head error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    }
    
    INIT_LIST_HEAD(</span>&amp;(_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> _head;
}


</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">管理员用户新增航班</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> tail_add_list_plant(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{    
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">50</span>] = {<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">};
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>],passwd[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *Node =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    Node </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node));
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(Node ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    }

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(name,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(passwd,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(name,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">admin</span><span style="color: rgba(128, 0, 0, 1)">"</span>) == <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; strcmp(passwd,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">admin123</span><span style="color: rgba(128, 0, 0, 1)">"</span>) == <span style="color: rgba(128, 0, 128, 1)">0</span>)<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">管理员用户才可以修改航班信息，账户为admin，密码为admin123</span>
<span style="color: rgba(0, 0, 0, 1)">    {    
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">name,name);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">passwd,passwd);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">number:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">number:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">number,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1. 打开目录</span>
        DIR *dp = opendir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./date</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(dp ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
        {
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
            sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        }
        
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. 切换到目录下</span>
        chdir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./date</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

        sprintf(buff,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s.txt</span><span style="color: rgba(128, 0, 0, 1)">"</span>,Node-&gt;<span style="color: rgba(0, 0, 0, 1)">number);

        FILE </span>*fp = fopen(buff,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">a</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));    

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">staddress:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">staddress:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">staddress,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">arraddress:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">arraddress:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">arraddress,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">date:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">date:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">date,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">type:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">type:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">type,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">stime:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">stime:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">stime,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">price:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">price:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">price,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

        sprintf(buff,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s,%s,%s,%s,%s,%s,%s</span><span style="color: rgba(128, 0, 0, 1)">"</span>,Node-&gt;number,Node-&gt;staddress,Node-&gt;arraddress,Node-&gt;date,Node-&gt;type,Node-&gt;stime,Node-&gt;<span style="color: rgba(0, 0, 0, 1)">price);

        fwrite(buff,</span><span style="color: rgba(128, 0, 128, 1)">50</span>,<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">,fp);

        list_add_tail(</span>&amp;(Node-&gt;list),&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
        fclose(fp);
        chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">../</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        closedir(dp);
        </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
    }
    </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)"> 
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">You're not the administrator\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
}
</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">管理员删除航班</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> delete_list_node_number(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">50</span>] = {<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">};
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buf[<span style="color: rgba(128, 0, 128, 1)">50</span>] = {<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">};
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>],passwd[<span style="color: rgba(128, 0, 128, 1)">10</span>],number[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *q =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(name,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(passwd,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(name,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">admin</span><span style="color: rgba(128, 0, 0, 1)">"</span>) == <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; strcmp(passwd,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">admin123</span><span style="color: rgba(128, 0, 0, 1)">"</span>) == <span style="color: rgba(128, 0, 128, 1)">0</span>)<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">管理员用户才可以修改航班信息，账户为admin，密码为admin123</span>
<span style="color: rgba(0, 0, 0, 1)">    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">number:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">number:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(number,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        list_for_each_entry_safe(p,q,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list),list)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(p-&gt;number,number) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {    
                DIR </span>*dp = opendir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./date</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">if</span>(dp ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
                {
                    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                }
        
                </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. 切换到目录下</span>
                chdir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./date</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                sprintf(buff,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">rm %s.txt</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,number);
                system(buff); 

                list_del(</span>&amp;(p-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
                </span><span style="color: rgba(0, 0, 255, 1)">free</span><span style="color: rgba(0, 0, 0, 1)">(p);
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s remove\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,number);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s remove!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,number);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">../</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                closedir(dp);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
            }
        }
    }
    </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">You don't have access \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">You don't have access\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> -<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户注册</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> tail_add_list_user(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *Node =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">100</span><span style="color: rgba(0, 0, 0, 1)">];
    Node </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node));
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(Node ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    }


    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">name,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">passwd,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    DIR </span>*dp = opendir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./register</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(dp ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    }
        
    chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./register</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

    sprintf(buff,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s.txt</span><span style="color: rgba(128, 0, 0, 1)">"</span>,Node-&gt;<span style="color: rgba(0, 0, 0, 1)">name);

    FILE </span>*fp = fopen(buff,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">a</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));    

    sprintf(buff,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s,%s</span><span style="color: rgba(128, 0, 0, 1)">"</span>,Node-&gt;name,Node-&gt;<span style="color: rgba(0, 0, 0, 1)">passwd);

    fwrite(buff,</span><span style="color: rgba(128, 0, 128, 1)">50</span>,<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">,fp);

    fclose(fp);

    chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">../</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    closedir(dp);

    list_add_tail(</span>&amp;(Node-&gt;list),&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
        
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Registration Successful\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Registration Successful\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户登入购买票系统,返回注册后用户的地址</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *user_name_show_list(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>],passwd[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input your name:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(name,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">passwd:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(passwd,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

    list_for_each_prev(p,</span>&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
    {
        tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(name,tmp-&gt;name) == <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; strcmp(passwd,tmp-&gt;passwd) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> tmp;
    }

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you do namet register\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you do namet register\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span><span style="color: rgba(0, 0, 0, 1)"> NULL;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户购票,输入登陆用户的地址和航班的头</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> user_buy_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> a,b,c;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> number[<span style="color: rgba(128, 0, 128, 1)">10</span>],buf[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">pleasse input number:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">pleasse input number:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(number,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    list_for_each_prev(p,</span>&amp;(p_head-&gt;list))<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">查看用户是否购买过此航班</span>
<span style="color: rgba(0, 0, 0, 1)">    {
        tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;number,u_head-&gt;number) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you have %s fight \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">number);
            bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
            sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you have %s fight \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">number);
            send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        }
    }

    list_for_each_prev(p,</span>&amp;(p_head-&gt;list))<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">未购买则执行买票程序</span>
<span style="color: rgba(0, 0, 0, 1)">    {
        tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;number,number) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(u_head-&gt;price == <span style="color: rgba(128, 0, 128, 1)">0</span>)<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">判断是否是第一张机票</span>
<span style="color: rgba(0, 0, 0, 1)">            {
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">name);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">name);

                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                strcpy(u_head</span>-&gt;number,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">number);
                strcpy(u_head</span>-&gt;staddress,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">staddress);
                strcpy(u_head</span>-&gt;arraddress,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">arraddress);
                strcpy(u_head</span>-&gt;date,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">date);    
                strcpy(u_head</span>-&gt;type,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">type);
                strcpy(u_head</span>-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">stime);
                strcpy(u_head</span>-&gt;price,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                strcpy(u_head</span>-&gt;price,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                strcpy(u_head</span>-&gt;aggregate,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you need pay for %s rmb</span><span style="color: rgba(128, 0, 0, 1)">"</span>,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">aggregate);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you need pay for %s rmb</span><span style="color: rgba(128, 0, 0, 1)">"</span>,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">aggregate);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
            }
            </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">如果不是第一张机票则在链表后加一节点</span>
<span style="color: rgba(0, 0, 0, 1)">            {
                </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *Node =<span style="color: rgba(0, 0, 0, 1)"> NULL;
                Node </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node));
                </span><span style="color: rgba(0, 0, 255, 1)">if</span>(Node ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
                {
                    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                }

                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">name);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">name);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                strcpy(Node</span>-&gt;name,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">name);
                strcpy(Node</span>-&gt;passwd,u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">passwd);
                strcpy(Node</span>-&gt;number,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">number);
                strcpy(Node</span>-&gt;staddress,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">staddress);
                strcpy(Node</span>-&gt;arraddress,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">arraddress);
                strcpy(Node</span>-&gt;date,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">date);    
                strcpy(Node</span>-&gt;type,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">type);
                strcpy(Node</span>-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">stime);
                strcpy(Node</span>-&gt;price,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                strcpy(Node</span>-&gt;price,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                a </span>= atoi(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                b </span>= atoi(tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                c </span>= a+<span style="color: rgba(0, 0, 0, 1)">b;
                sprintf(buf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%d</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,c);
                strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">aggregate,buf);
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you need pay for %d rmb\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,b);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you need pay for %d rmb\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,b);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                list_add_tail(</span>&amp;(Node-&gt;list),&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));

            }
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">buy successful\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
            sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">buy successful\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        }
    }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户退票,输入登陆用户的地址和航班的头</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> user_ret_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> number[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *q =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *obj =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    
    list_for_each_prev(p,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
        {
            tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;number,u_head-&gt;number) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {
                tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
            }
            </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)"> 
                list_for_each_prev(q,</span>&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
                {
                    obj </span>= list_entry(q,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(obj-&gt;number,tmp-&gt;number) == <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; strcmp(obj-&gt;name,u_head-&gt;name) ==<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,obj-&gt;number,obj-&gt;staddress,obj-&gt;arraddress,obj-&gt;date,obj-&gt;type,obj-&gt;stime,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,obj-&gt;number,obj-&gt;staddress,obj-&gt;arraddress,obj-&gt;date,obj-&gt;type,obj-&gt;stime,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);            
                    }
                    
                }
        }
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Please enter the flight you want to return:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Please enter the flight you want to return:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(number,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    list_for_each_safe(p,q,</span>&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
        {
            tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;number,number) == <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; strcmp(tmp-&gt;name,u_head-&gt;name) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {    
                    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">return you %s rmb\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">return you %s rmb\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                    list_del(p); 
                    </span><span style="color: rgba(0, 0, 255, 1)">free</span><span style="color: rgba(0, 0, 0, 1)">(tmp); 
                    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
            }        
        }

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you don't hav fight\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you don't hav fight\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> -<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
}
</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户改签,输入登陆用户的地址和航班的头</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> user_tic_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> a,b,c,d;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> number[<span style="color: rgba(128, 0, 128, 1)">10</span>],p_number[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *q =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *obj =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">50</span>],buf[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

    list_for_each_prev(p,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
        {
            tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;number,u_head-&gt;number) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s    %s    %s  %s      %s   %s     %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
            }
            </span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)"> 
                list_for_each_prev(q,</span>&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
                {
                    obj </span>= list_entry(q,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(obj-&gt;number,tmp-&gt;number) == <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; strcmp(obj-&gt;name,u_head-&gt;name) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s    %s    %s  %s      %s   %s     %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,obj-&gt;number,obj-&gt;staddress,obj-&gt;arraddress,obj-&gt;date,obj-&gt;type,obj-&gt;stime,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">price);    
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,obj-&gt;number,obj-&gt;staddress,obj-&gt;arraddress,obj-&gt;date,obj-&gt;type,obj-&gt;stime,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);    
                    }
                    
                }
        }
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);    
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Please enter the flight you want to change:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Please enter the flight you want to change:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(number,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Flights to be rescheduled:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Flights to be rescheduled:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(p_number,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    list_for_each_prev(p,</span>&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
    {
        tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;number,number) == <span style="color: rgba(128, 0, 128, 1)">0</span> &amp;&amp; strcmp(tmp-&gt;name,u_head-&gt;name) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            list_for_each_prev(q,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
            {
            obj </span>= list_entry(q,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(obj-&gt;number,p_number) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {
                strcpy(tmp</span>-&gt;number,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">number);
                strcpy(tmp</span>-&gt;staddress,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">staddress);
                strcpy(tmp</span>-&gt;arraddress,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">arraddress);
                strcpy(tmp</span>-&gt;date,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">date);    
                strcpy(tmp</span>-&gt;type,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">type);
                strcpy(tmp</span>-&gt;stime,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">stime);
                a </span>= atoi(tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                strcpy(tmp</span>-&gt;price,obj-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                b </span>= atoi(obj-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                c </span>= a -<span style="color: rgba(0, 0, 0, 1)"> b;
                d </span>= atoi(tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">aggregate);
                d </span>= d +<span style="color: rgba(0, 0, 0, 1)"> c;
                sprintf(buf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%d</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,d);
                strcpy(tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">aggregate,buf);
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you need pay for %d rmb\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,c);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you need pay for %d rmb\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,c);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Endorsed to success\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Endorsed to success\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
            }
            }
            
        }
    }    
    

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you don't hav fight\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">you don't hav fight\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> -<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
}    

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户查看所有航班信息</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> user_show_all_list(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

    list_for_each_prev(p,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
    {
        tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);    
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    }
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户通过航班号查看航班==========快速查询</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> user_number_show_list(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">char</span> number[<span style="color: rgba(128, 0, 128, 1)">10</span>],<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

    list_for_each(p,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
    {
        tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;number,number) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
            bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
            sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
            send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        }
    }

    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">普通用户时间/日期/机型查询航班查看航班==========条件查询</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> user_condition_show_list(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span><span style="color: rgba(0, 0, 0, 1)"> num;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> stime[<span style="color: rgba(128, 0, 128, 1)">10</span>],date[<span style="color: rgba(128, 0, 128, 1)">10</span>],type[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp = NULL;<span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">50</span><span style="color: rgba(0, 0, 0, 1)">];
    bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));

    
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {    
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">What would you like to inquire through:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">What would you like to inquire through:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.departure time\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.departure time\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.date\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.date\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.type\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.type\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">4.exit\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">4.exit\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">num,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        </span><span style="color: rgba(0, 0, 255, 1)">switch</span><span style="color: rgba(0, 0, 0, 1)">(num)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">:
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input time:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input time:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                {
                    strcpy(stime,chars);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                }
                list_for_each(p,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
                {
                    tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;stime,stime) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                    }
                }
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">:
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input date:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input date:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                {
                    strcpy(date,chars);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                }
                list_for_each(p,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
                {
                    tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;date,date) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                    }
                }
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">:
                printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input type:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input type:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                {
                    strcpy(type,chars);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                }

                list_for_each(p,</span>&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
                {
                    tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strcmp(tmp-&gt;type,type) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  number    staddress    arraddress    date    type    stime    price    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">  %s        %s            %s      %s   %s     %s   %s    \n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;number,tmp-&gt;staddress,tmp-&gt;arraddress,tmp-&gt;date,tmp-&gt;type,tmp-&gt;stime,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

                        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================================================================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                    }
                }
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">:
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">:
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
    
        }
        
        }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> -<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">释放整条链表</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> delete_list(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *<span style="color: rgba(0, 0, 0, 1)">_head)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *q =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    
    list_for_each_entry_safe(p,q,</span>&amp;(_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list),list)
    {
        list_del(</span>&amp;(p-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
        </span><span style="color: rgba(0, 0, 255, 1)">free</span><span style="color: rgba(0, 0, 0, 1)">(p);
    }
    
    list_del(</span>&amp;(_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
    </span><span style="color: rgba(0, 0, 255, 1)">free</span><span style="color: rgba(0, 0, 0, 1)">(_head);
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">航班管理触摸处理函数</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> flight_track_fun(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{

    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">6</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;
    fd_set rset;
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> maxfd = connfd &gt; STDIN_FILENO ?<span style="color: rgba(0, 0, 0, 1)"> connfd : STDIN_FILENO;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        FD_ZERO(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(connfd,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(STDIN_FILENO,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        </span><span style="color: rgba(0, 0, 255, 1)">select</span>(maxfd+<span style="color: rgba(128, 0, 128, 1)">1</span>,&amp;<span style="color: rgba(0, 0, 0, 1)">rset,NULL,NULL,NULL);

            
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(FD_ISSET(STDIN_FILENO,&amp;<span style="color: rgba(0, 0, 0, 1)">rset))
        {
            bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
            fgets(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff),stdin);
            </span><span style="color: rgba(0, 0, 255, 1)">get</span> =<span style="color: rgba(0, 0, 0, 1)"> atoi(buff);
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(connfd != <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(recv(connfd,buff,<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(buff),<span style="color: rgba(128, 0, 128, 1)">0</span>)&gt;<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {
                </span><span style="color: rgba(0, 0, 255, 1)">get</span> =<span style="color: rgba(0, 0, 0, 1)"> atoi(buff);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;    
            }    
        }
    }

    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">子主界面触摸处理函数</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> sun_main_interface_fun(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{

    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">6</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;
    fd_set rset;    
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> maxfd = connfd &gt; STDIN_FILENO ?<span style="color: rgba(0, 0, 0, 1)"> connfd: STDIN_FILENO;

    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        FD_ZERO(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(connfd,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(STDIN_FILENO,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        </span><span style="color: rgba(0, 0, 255, 1)">select</span>(maxfd+<span style="color: rgba(128, 0, 128, 1)">1</span>,&amp;<span style="color: rgba(0, 0, 0, 1)">rset,NULL,NULL,NULL);

            
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(FD_ISSET(STDIN_FILENO,&amp;<span style="color: rgba(0, 0, 0, 1)">rset))
        {
            bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
            fgets(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff),stdin);
            </span><span style="color: rgba(0, 0, 255, 1)">get</span> =<span style="color: rgba(0, 0, 0, 1)"> atoi(buff);
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(connfd != <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(recv(connfd,buff,<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(buff),<span style="color: rgba(128, 0, 128, 1)">0</span>)&gt;<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {
                </span><span style="color: rgba(0, 0, 255, 1)">get</span> =<span style="color: rgba(0, 0, 0, 1)"> atoi(buff);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;    
            }    
        }
    }

    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">主界面触摸处理函数</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> main_interface_fun(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">6</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;
    fd_set rset;
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> maxfd =connfd &gt; STDIN_FILENO ?<span style="color: rgba(0, 0, 0, 1)"> connfd : STDIN_FILENO;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        FD_ZERO(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(connfd,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        FD_SET(STDIN_FILENO,</span>&amp;<span style="color: rgba(0, 0, 0, 1)">rset);
        </span><span style="color: rgba(0, 0, 255, 1)">select</span>(maxfd+<span style="color: rgba(128, 0, 128, 1)">1</span>,&amp;<span style="color: rgba(0, 0, 0, 1)">rset,NULL,NULL,NULL);

            
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(FD_ISSET(STDIN_FILENO,&amp;<span style="color: rgba(0, 0, 0, 1)">rset))
        {
            bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
            fgets(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff),stdin);
            </span><span style="color: rgba(0, 0, 255, 1)">get</span> =<span style="color: rgba(0, 0, 0, 1)"> atoi(buff);
            </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(connfd != <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
            </span><span style="color: rgba(0, 0, 255, 1)">if</span>(recv(connfd,buff,<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(buff),<span style="color: rgba(128, 0, 128, 1)">0</span>)&gt;<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
            {
                </span><span style="color: rgba(0, 0, 255, 1)">get</span> =<span style="color: rgba(0, 0, 0, 1)"> atoi(buff);
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(0, 0, 255, 1)">get</span><span style="color: rgba(0, 0, 0, 1)">;    
            }    
        }

    }

    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">管理航班信息，输入航班头</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> manage_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span><span style="color: rgba(0, 0, 0, 1)"> num;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">========manage menu=======\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">========manage menu=======\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.Add flights\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">添加航班信息</span>
        bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.Add flights\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.Modify the flight\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">添加航班信息</span>
        bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.Modify the flight\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.exit manage menu\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">添加航班信息</span>
        bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.exit manage menu\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">===========================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Please enter your choice:</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">Please enter your choice:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            strcpy(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">num,chars);
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
        </span><span style="color: rgba(0, 0, 255, 1)">switch</span><span style="color: rgba(0, 0, 0, 1)">(num)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">:
                tail_add_list_plant(p_head,connfd);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">:
                delete_list_node_number(p_head,connfd);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">:
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">:
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> -<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">主界面---显示登陆界面：</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> home_screen_fun(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">========Home Screen=========\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">========Home Screen=========\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.register\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">用户注册，需调用tail_add_list_user(struct list_node *u_head)</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.register\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.login\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">用户登陆，需调用menu_fun()</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.login\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.manage\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">管理航班，添加航班或删除航班,需调用manage_fun(struct list_node *p_head)</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.manage\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">4.exit\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">退出程序</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">4.exit\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">主菜单---显示登陆成功：</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> menu_fun(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">========MENU=========\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">========MENU=========\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.Show all flights\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">查询所有航班</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">1.Show all flights\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.Criteria Query\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">条件查询</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">2.Criteria Query\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.fasttips\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">快速查询</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">3.fasttips\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">4.buy ticket\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">购票</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">4.buy ticket\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">5.ticket changing\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">改签</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">5.ticket changing\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">6.dishonoured cheque\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">退票</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">6.dishonoured cheque\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">7.exit menu\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">退出登陆</span>
    bzero(sendbuf,<span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">7.exit menu\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">=====================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
}


</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">管理航班子菜单</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> manage_fun_su(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> ret;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        ret </span>=<span style="color: rgba(0, 0, 0, 1)"> flight_track_fun(connfd);
        </span><span style="color: rgba(0, 0, 255, 1)">switch</span><span style="color: rgba(0, 0, 0, 1)">(ret)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">:
                tail_add_list_plant(p_head,connfd);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">:
                delete_list_node_number(p_head,connfd);
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">3</span><span style="color: rgba(0, 0, 0, 1)">:
                </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            </span><span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">:
                </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

    }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">用户登陆子函数</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> usre_landing_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> touch;
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> num[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];

    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {    
        menu_fun(connfd);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">crt显示菜单</span>
        touch =<span style="color: rgba(0, 0, 0, 1)"> sun_main_interface_fun(connfd);
        </span><span style="color: rgba(0, 0, 255, 1)">switch</span><span style="color: rgba(0, 0, 0, 1)">(touch)
        {
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">1</span>:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1、查询所有航班</span>
<span style="color: rgba(0, 0, 0, 1)">                    user_show_all_list(p_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">2</span>:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2、条件查询</span>
<span style="color: rgba(0, 0, 0, 1)">                    user_condition_show_list(p_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">3</span>:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3、快速查询</span>
                    printf(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input you need inquire number:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                    bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
                    sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">please input you need inquire number:\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
                    send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
                    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(char_input(connfd) == <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
                    {
                        strcpy(num,chars);
                        </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                    }
                    user_number_show_list(p_head,num,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">4</span>:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4、购票</span>
<span style="color: rgba(0, 0, 0, 1)">                    user_buy_fun(u_head,p_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">5</span>:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">5、改签</span>
<span style="color: rgba(0, 0, 0, 1)">                    user_tic_fun(u_head,p_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">6</span>:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">6、退票</span>
<span style="color: rgba(0, 0, 0, 1)">                    user_ret_fun(u_head,p_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">7</span>:<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">7、退出登陆</span>
                    <span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">;
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">:
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }

    }
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">从文件中读取航班信息</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> date_reading_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>],passwd[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1. 打开目录</span>
    DIR *dp = opendir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./date</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(dp ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    }
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. 切换到目录下</span>
    chdir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./date</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3. 读取目录中每一项</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span> dirent *ep =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        ep </span>=<span style="color: rgba(0, 0, 0, 1)"> readdir(dp);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(ep == NULL)  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">读取完毕</span>
            <span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(ep-&gt;d_name[<span style="color: rgba(128, 0, 128, 1)">0</span>] == <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">)
            </span><span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;
    
        </span><span style="color: rgba(0, 0, 255, 1)">char</span> str[<span style="color: rgba(128, 0, 128, 1)">50</span>] = {<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">};
        FILE </span>*fp = fopen(ep-&gt;d_name,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">r</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        
        fread(str,</span><span style="color: rgba(128, 0, 128, 1)">10</span>,<span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">,fp);
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">printf("%s\n",str);</span>
        <span style="color: rgba(0, 0, 255, 1)">char</span> seps[] = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">; 
        </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *Node =<span style="color: rgba(0, 0, 0, 1)"> NULL;
        Node </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node));
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(Node ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
        {
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
            sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        }

        strcpy(Node</span>-&gt;name,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">admin</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        strcpy(Node</span>-&gt;passwd,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">admin123</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

        </span><span style="color: rgba(0, 0, 255, 1)">char</span> *<span style="color: rgba(0, 0, 0, 1)">tmp;
        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(str,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">number,tmp);
        
        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">staddress,tmp);
        
        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">arraddress,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">date,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">type,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">stime,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">price,tmp);

        fclose(fp);

        list_add_tail(</span>&amp;(Node-&gt;list),&amp;(p_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
    }

    chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">../</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">切换回上一级目录
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4. 关闭目录</span>
<span style="color: rgba(0, 0, 0, 1)">    closedir(dp);
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">从文件中读取用户注册信息</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> register_reading_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>],passwd[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1. 打开目录</span>
    DIR *dp = opendir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./register</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(dp ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    }
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. 切换到目录下</span>
    chdir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./register</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3. 读取目录中每一项</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span> dirent *ep =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        ep </span>=<span style="color: rgba(0, 0, 0, 1)"> readdir(dp);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(ep == NULL)  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">读取完毕</span>
            <span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(ep-&gt;d_name[<span style="color: rgba(128, 0, 128, 1)">0</span>] == <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">)
            </span><span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;
    
        </span><span style="color: rgba(0, 0, 255, 1)">char</span> str[<span style="color: rgba(128, 0, 128, 1)">50</span>] = {<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">};
        FILE </span>*fp = fopen(ep-&gt;d_name,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">r</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        
        fread(str,</span><span style="color: rgba(128, 0, 128, 1)">10</span>,<span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">,fp);
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">printf("%s\n",str);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)"> name,passwd</span>
        
        <span style="color: rgba(0, 0, 255, 1)">char</span> seps[] = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">,</span><span style="color: rgba(128, 0, 0, 1)">"</span>;  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">分隔的字符是什么</span>
        <span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *Node =<span style="color: rgba(0, 0, 0, 1)"> NULL;
        Node </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node));
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(Node ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
        {
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
            sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        }

        </span><span style="color: rgba(0, 0, 255, 1)">char</span> *<span style="color: rgba(0, 0, 0, 1)">tmp;
        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(str,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">name,tmp);
        
        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">passwd,tmp);

        fclose(fp);

        list_add_tail(</span>&amp;(Node-&gt;list),&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
    }

    chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">../</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">切换回上一级目录
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4. 关闭目录</span>
<span style="color: rgba(0, 0, 0, 1)">    closedir(dp);
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">从文件中读取用户购票信息</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> date_login_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>],passwd[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1. 打开目录</span>
    DIR *dp = opendir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./user</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(dp ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    }
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. 切换到目录下</span>
    chdir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./user</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3. 读取目录中每一项</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span> dirent *ep =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        ep </span>=<span style="color: rgba(0, 0, 0, 1)"> readdir(dp);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(ep == NULL)  <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">读取完毕</span>
            <span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
            
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(ep-&gt;d_name[<span style="color: rgba(128, 0, 128, 1)">0</span>] == <span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(128, 0, 0, 1)">.</span><span style="color: rgba(128, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">)
            </span><span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;

        </span><span style="color: rgba(0, 0, 255, 1)">char</span> str[<span style="color: rgba(128, 0, 128, 1)">500</span>] = {<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">};
        FILE </span>*fp = fopen(ep-&gt;d_name,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">r</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        
        fread(str,</span><span style="color: rgba(128, 0, 128, 1)">100</span>,<span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">,fp);
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">printf("%s\n",str);</span>
        <span style="color: rgba(0, 0, 255, 1)">char</span> seps[] = <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">; 
        </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *Node =<span style="color: rgba(0, 0, 0, 1)"> NULL;
        Node </span>= (<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *)<span style="color: rgba(0, 0, 255, 1)">malloc</span>(<span style="color: rgba(0, 0, 255, 1)">sizeof</span>(<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node));
        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(Node ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
        {
            printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
            sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">malloc Node error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
            send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        }

        </span><span style="color: rgba(0, 0, 255, 1)">char</span> *<span style="color: rgba(0, 0, 0, 1)">tmp;

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(str,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">name,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">passwd,tmp);
        
        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">number,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">staddress,tmp);
        
        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">arraddress,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">date,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">type,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps); 
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">stime,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">price,tmp);

        tmp </span>=<span style="color: rgba(0, 0, 0, 1)"> strtok(NULL,seps);
        strcpy(Node</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">aggregate,tmp);

        fclose(fp);

        list_add_tail(</span>&amp;(Node-&gt;list),&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list));
    }

    chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">../</span><span style="color: rgba(128, 0, 0, 1)">"</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">切换回上一级目录
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4. 关闭目录</span>
<span style="color: rgba(0, 0, 0, 1)">    closedir(dp);
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}
</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">存储所有购票信息</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> store_all_ticket(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{    
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buff[<span style="color: rgba(128, 0, 128, 1)">500</span>],nm[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> name[<span style="color: rgba(128, 0, 128, 1)">10</span>],passwd[<span style="color: rgba(128, 0, 128, 1)">10</span>],number[<span style="color: rgba(128, 0, 128, 1)">10</span>],staddress[<span style="color: rgba(128, 0, 128, 1)">10</span>],arraddress[<span style="color: rgba(128, 0, 128, 1)">10</span>],date[<span style="color: rgba(128, 0, 128, 1)">10</span>],type[<span style="color: rgba(128, 0, 128, 1)">10</span>],stime[<span style="color: rgba(128, 0, 128, 1)">10</span>],price[<span style="color: rgba(128, 0, 128, 1)">10</span>],aggregate[<span style="color: rgba(128, 0, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *p =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *tmp =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1. 打开目录</span>
    DIR *dp = opendir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./user</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(dp ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
    {
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        bzero(sendbuf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(sendbuf));
        sprintf(sendbuf,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">opendir error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        send(connfd,sendbuf,strlen(sendbuf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    }

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. 切换到目录下</span>
    chdir(<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">./user</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    
    bzero(nm,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(nm));
    sprintf(nm,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">rm *.txt</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    system(nm);

    bzero(buff,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buff));
    bzero(nm,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(nm));

    list_for_each(p,</span>&amp;(u_head-&gt;<span style="color: rgba(0, 0, 0, 1)">list))
    {
        
        tmp </span>= list_entry(p,<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_node,list);
        </span><span style="color: rgba(0, 0, 255, 1)">if</span> (atoi(tmp-&gt;price) != <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
        sprintf(nm,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s %s.txt</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;name,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">number);
        FILE </span>*fp = fopen(nm,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">w+</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);

        strcpy(name,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">name);
        strcpy(passwd,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">passwd);    
        strcpy(number,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">number);
        strcpy(staddress,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">staddress);
        strcpy(arraddress,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">arraddress);
        strcpy(date,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">date);
        strcpy(type,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">type);
        strcpy(stime,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">stime);
        strcpy(price,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">price);
        strcpy(aggregate,tmp</span>-&gt;<span style="color: rgba(0, 0, 0, 1)">aggregate);
        sprintf(buff,</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s,%s,%s,%s,%s,%s,%s,%s,%s,%s</span><span style="color: rgba(128, 0, 0, 1)">"</span>,tmp-&gt;<span style="color: rgba(0, 0, 0, 1)">name,passwd,number,staddress,arraddress,date,type,stime,price,aggregate);
        fwrite(buff,</span><span style="color: rgba(128, 0, 128, 1)">50</span>,<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">,fp);

        fclose(fp);
        }
    }
    chdir(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">../</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    closedir(dp);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">退出程序</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">int</span> exit_fun(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head,<span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head,<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd)
{

    </span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">保存用户的购票信息</span><span style="color: rgba(0, 128, 0, 1)">*/</span><span style="color: rgba(0, 0, 0, 1)">
    store_all_ticket(u_head,connfd);
    </span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">释放链表</span><span style="color: rgba(0, 128, 0, 1)">*/</span><span style="color: rgba(0, 0, 0, 1)">
    delete_list(u_head);

    delete_list(p_head);
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}


</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">子线程处理函数</span>
<span style="color: rgba(0, 0, 255, 1)">void</span> * fun(<span style="color: rgba(0, 0, 255, 1)">void</span> *<span style="color: rgba(0, 0, 0, 1)">arg)
{
    </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd;
    pthread_t tid;
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">获得连接的客户端已连接套接字、本线程的tid</span>
    connfd = *(<span style="color: rgba(0, 0, 255, 1)">int</span> *<span style="color: rgba(0, 0, 0, 1)">)arg;
    tid </span>=<span style="color: rgba(0, 0, 0, 1)"> pthread_self();

    </span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">初始化链表</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *p_head =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_head =<span style="color: rgba(0, 0, 0, 1)"> NULL;
    u_head </span>=<span style="color: rgba(0, 0, 0, 1)"> init_list_head(u_head,connfd);
    p_head </span>=<span style="color: rgba(0, 0, 0, 1)"> init_list_head(p_head,connfd);
    
    date_reading_fun(p_head,connfd);
    date_login_fun(u_head,connfd);
    register_reading_fun(u_head,connfd);

    
    </span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">定义变量</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
    <span style="color: rgba(0, 0, 255, 1)">int</span> ret;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">用于判定用户选择</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span> list_node *u_ret;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">普通用户登陆，接收user_name_show_list返回值</span>
    sleep(<span style="color: rgba(128, 0, 128, 1)">3</span>);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">等待3秒</span>
    <span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        {    
            home_screen_fun(connfd);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">crt显示主界面</span>
            ret =<span style="color: rgba(0, 0, 0, 1)"> main_interface_fun(connfd);
            </span><span style="color: rgba(0, 0, 255, 1)">switch</span><span style="color: rgba(0, 0, 0, 1)">(ret)
            {
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">1</span> :<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">用户注册</span>
<span style="color: rgba(0, 0, 0, 1)">                    tail_add_list_user(u_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">2</span> :<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">用户登陆</span>
                    u_ret =<span style="color: rgba(0, 0, 0, 1)"> user_name_show_list(u_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(u_ret ==<span style="color: rgba(0, 0, 0, 1)"> NULL)
                        </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                    usre_landing_fun(u_ret,p_head,connfd);</span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">用户登陆子菜单</span>
                    <span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">3</span> :<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">管理航班</span>
<span style="color: rgba(0, 0, 0, 1)">                    manage_fun_su(p_head,connfd);
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">case</span> <span style="color: rgba(128, 0, 128, 1)">4</span> :<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">退出程序</span>
                    exit_fun(p_head,u_head,connfd);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">退出程序</span>
                    sleep(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">);    
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
                </span><span style="color: rgba(0, 0, 255, 1)">default</span><span style="color: rgba(0, 0, 0, 1)">:
                    </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;


            }
        }
        

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">删除该线程对应的链表节点</span>
<span style="color: rgba(0, 0, 0, 1)">    delete_list_node_num_ip(head,tid);
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">关闭连接套接字</span>
<span style="color: rgba(0, 0, 0, 1)">    close(connfd);
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">线程退出</span>
<span style="color: rgba(0, 0, 0, 1)">    pthread_exit(NULL);

}

</span><span style="color: rgba(0, 0, 255, 1)">int</span> main(<span style="color: rgba(0, 0, 255, 1)">int</span> argc, <span style="color: rgba(0, 0, 255, 1)">char</span> <span style="color: rgba(0, 0, 255, 1)">const</span> *<span style="color: rgba(0, 0, 0, 1)">argv[])
{
    pthread_t tid;

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">初始化链表</span>
    head =<span style="color: rgba(0, 0, 0, 1)"> init_list_head_ip(head);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">创建未连接套接字</span>
    <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> sockfd;
    sockfd </span>= socket(AF_INET,SOCK_STREAM,<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">socket:%d\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,sockfd);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">绑定IP地址，端口号等到未连接的套接字中</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> sockaddr_in srvaddr;
    socklen_t len </span>= <span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(srvaddr);
    bzero(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">srvaddr,len);

    srvaddr.sin_family </span>= AF_INET;            <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">协议</span>
    srvaddr.sin_port = htons(atoi(argv[<span style="color: rgba(128, 0, 128, 1)">1</span>]));<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">端口号</span>
    srvaddr.sin_addr.s_addr = htonl(INADDR_ANY);<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">服务器ip</span>
    bind(sockfd,(<span style="color: rgba(0, 0, 255, 1)">struct</span> sockaddr *)&amp;<span style="color: rgba(0, 0, 0, 1)">srvaddr,len);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">设置监听套接字</span>
    listen(sockfd,<span style="color: rgba(128, 0, 128, 1)">5</span><span style="color: rgba(0, 0, 0, 1)">);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">等待连接</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> sockaddr_in cliaddr;
    </span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> connfd;
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">等待连接，连接上就创建线程并将connfd传递给子线程，信息记入链表</span>
        connfd = accept(sockfd,(<span style="color: rgba(0, 0, 255, 1)">struct</span> sockaddr *)&amp;cliaddr,&amp;<span style="color: rgba(0, 0, 0, 1)">len);
        pthread_create(</span>&amp;tid,NULL,fun,(<span style="color: rgba(0, 0, 255, 1)">void</span> *)&amp;<span style="color: rgba(0, 0, 0, 1)">connfd);
        add_list_node_ip(head,connfd,(</span><span style="color: rgba(0, 0, 255, 1)">char</span> *<span style="color: rgba(0, 0, 0, 1)">)inet_ntoa(cliaddr.sin_addr),tid);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">connfd:%d\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,connfd);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">new connection:%s\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,(<span style="color: rgba(0, 0, 255, 1)">char</span> *<span style="color: rgba(0, 0, 0, 1)">)inet_ntoa(cliaddr.sin_addr));
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">tid:%d\n</span><span style="color: rgba(128, 0, 0, 1)">"</span>,(<span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">)tid);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">============================\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
        </span><span style="color: rgba(0, 0, 255, 1)">continue</span><span style="color: rgba(0, 0, 0, 1)">;
    }

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">接合最后一个线程</span>
<span style="color: rgba(0, 0, 0, 1)">    pthread_join(tid,NULL);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">删除整条链表</span>
<span style="color: rgba(0, 0, 0, 1)">    delete_list_ip(head);

    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">关闭未来连接套接字</span>
<span style="color: rgba(0, 0, 0, 1)">    close(sockfd);

    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>head</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: rgba(0, 0, 0, 1)">#ifndef _HEAD_H_
</span><span style="color: rgba(0, 0, 255, 1)">#define</span> _HEAD_H_<span style="color: rgba(0, 0, 0, 1)">


#include </span>&lt;stdio.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;stdlib.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;<span style="color: rgba(0, 0, 255, 1)">string</span>.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;strings.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/stat.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;fcntl.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;unistd.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/types.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/mman.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;linux/input.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;dirent.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/wait.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;signal.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/ipc.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/msg.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/sem.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;pthread.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;semaphore.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/socket.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;netinet/<span style="color: rgba(0, 0, 255, 1)">in</span>.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;arpa/inet.h&gt;<span style="color: rgba(0, 0, 0, 1)">
#include </span>&lt;sys/<span style="color: rgba(0, 0, 255, 1)">select</span>.h&gt;<span style="color: rgba(0, 0, 0, 1)">    
#include </span>&lt;sys/time.h&gt;


















<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">#include "kernel_list.h"</span><span style="color: rgba(0, 128, 0, 1)">
/*</span><span style="color: rgba(0, 128, 0, 1)"> This file is from Linux Kernel (include/linux/list.h)
* and modified by simply removing hardware prefetching of list items.
* Here by copyright, credits attributed to wherever they belong.
* Kulesh Shanmugasundaram (kulesh [squiggly] isis.poly.edu)
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>

<span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">
* Simple doubly linked list implementation.
*
* Some of the internal functions (“__xxx”) are useful when
* manipulating whole lists rather than single entries, as
* sometimes we already know the next/prev entries and we can
* generate better code by using them directly rather than
* using the generic single-entry routines.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
 * container_of - cast a member of a structure out to the containing structure
 *
 * @ptr:    the pointer to the member.
 * @type:    the type of the container struct this is embedded in.
 * @member:    the name of the member within the struct.
 *
 </span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> offsetof(TYPE, MEMBER) ((size_t) &amp;((TYPE *)0)-&gt;MEMBER)

<span style="color: rgba(0, 0, 255, 1)">#define</span> container_of(ptr, type, member) ({            \
        <span style="color: rgba(0, 0, 255, 1)">const</span> <span style="color: rgba(0, 0, 255, 1)">typeof</span>( ((type *)<span style="color: rgba(128, 0, 128, 1)">0</span>)-&gt;member ) *__mptr =<span style="color: rgba(0, 0, 0, 1)"> (ptr);    \
        (type </span>*)( (<span style="color: rgba(0, 0, 255, 1)">char</span> *)__mptr -<span style="color: rgba(0, 0, 0, 1)"> offsetof(type,member) );})
</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">
 * These are non-NULL pointers that will result in page faults
 * under normal circumstances, used to verify that nobody uses
 * non-initialized list entries.
 </span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> LIST_POISON1  ((void *) 0x00100100)
<span style="color: rgba(0, 0, 255, 1)">#define</span> LIST_POISON2  ((void *) 0x00200)

<span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> list_head {
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *next, *<span style="color: rgba(0, 0, 0, 1)">prev;
};

</span><span style="color: rgba(0, 0, 255, 1)">#define</span> LIST_HEAD_INIT(name) { &amp;(name), &amp;(name) }

<span style="color: rgba(0, 0, 255, 1)">#define</span> LIST_HEAD(name) \
<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head name =<span style="color: rgba(0, 0, 0, 1)"> LIST_HEAD_INIT(name)

</span><span style="color: rgba(0, 0, 255, 1)">#define</span> INIT_LIST_HEAD(ptr) do { \<span style="color: rgba(0, 0, 0, 1)">
    (ptr)</span>-&gt;next = (ptr); (ptr)-&gt;prev =<span style="color: rgba(0, 0, 0, 1)"> (ptr); \
} </span><span style="color: rgba(0, 0, 255, 1)">while</span> (<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">
* Insert a new entry between two known consecutive entries.
*
* This is only for internal list manipulation where we know
* the prev/next entries already!
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> __list_add(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)">,
                </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">prev,
                </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">next)
{
    next</span>-&gt;prev = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)">;
    </span><span style="color: rgba(0, 0, 255, 1)">new</span>-&gt;next =<span style="color: rgba(0, 0, 0, 1)"> next;
    </span><span style="color: rgba(0, 0, 255, 1)">new</span>-&gt;prev =<span style="color: rgba(0, 0, 0, 1)"> prev;
    prev</span>-&gt;next = <span style="color: rgba(0, 0, 255, 1)">new</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_add – add a new entry
* @new: new entry to be added
* @head: list head to add it after
*
* Insert a new entry after the specified head.
* This is good for implementing stacks.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_add(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 255, 1)">new</span>, <span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
    __list_add(</span><span style="color: rgba(0, 0, 255, 1)">new</span>, head, head-&gt;<span style="color: rgba(0, 0, 0, 1)">next);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_add_tail – add a new entry
* @new: new entry to be added
* @head: list head to add it before
*
* Insert a new entry before the specified head.
* This is useful for implementing queues.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_add_tail(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 255, 1)">new</span>, <span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
    __list_add(</span><span style="color: rgba(0, 0, 255, 1)">new</span>, head-&gt;<span style="color: rgba(0, 0, 0, 1)">prev, head);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">
* Delete a list entry by making the prev/next entries
* point to each other.
*
* This is only for internal list manipulation where we know
* the prev/next entries already!
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> __list_del(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *prev, <span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">next)
{
    next</span>-&gt;prev =<span style="color: rgba(0, 0, 0, 1)"> prev;
    prev</span>-&gt;next =<span style="color: rgba(0, 0, 0, 1)"> next;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_del – deletes entry from list.
* @entry: the element to delete from the list.
* Note: list_empty on entry does not return true after this, the entry is in an undefined state.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_del(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">entry)
{
    __list_del(entry</span>-&gt;prev, entry-&gt;<span style="color: rgba(0, 0, 0, 1)">next);
    entry</span>-&gt;next = (<span style="color: rgba(0, 0, 255, 1)">void</span> *) <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
    entry</span>-&gt;prev = (<span style="color: rgba(0, 0, 255, 1)">void</span> *) <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_del_init – deletes entry from list and reinitialize it.
* @entry: the element to delete from the list.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_del_init(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">entry)
{
    __list_del(entry</span>-&gt;prev, entry-&gt;<span style="color: rgba(0, 0, 0, 1)">next);
    INIT_LIST_HEAD(entry);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_move – delete from one list and add as another’s head
* @list: the entry to move
* @head: the head that will precede our entry
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_move(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">list,
                </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
    __list_del(list</span>-&gt;prev, list-&gt;<span style="color: rgba(0, 0, 0, 1)">next);
    list_add(list, head);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_move_tail – delete from one list and add as another’s tail
* @list: the entry to move
* @head: the head that will follow our entry
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_move_tail(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">list,
                    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
    __list_del(list</span>-&gt;prev, list-&gt;<span style="color: rgba(0, 0, 0, 1)">next);
    list_add_tail(list, head);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_empty – tests whether a list is empty
* @head: the list to test.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">int</span> list_empty(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> head-&gt;next ==<span style="color: rgba(0, 0, 0, 1)"> head;
}

</span><span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> __list_splice(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">list,
                    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *first = list-&gt;<span style="color: rgba(0, 0, 0, 1)">next;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *last = list-&gt;<span style="color: rgba(0, 0, 0, 1)">prev;
    </span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *at = head-&gt;<span style="color: rgba(0, 0, 0, 1)">next;

    first</span>-&gt;prev =<span style="color: rgba(0, 0, 0, 1)"> head;
    head</span>-&gt;next =<span style="color: rgba(0, 0, 0, 1)"> first;

    last</span>-&gt;next =<span style="color: rgba(0, 0, 0, 1)"> at;
    at</span>-&gt;prev =<span style="color: rgba(0, 0, 0, 1)"> last;
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_splice – join two lists
* @list: the new list to add.
* @head: the place to add it in the first list.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_splice(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *list, <span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">list_empty(list))
__list_splice(list, head);
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_splice_init – join two lists and reinitialise the emptied list.
* @list: the new list to add.
* @head: the place to add it in the first list.
*
* The list at @list is reinitialised
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">static</span> inline <span style="color: rgba(0, 0, 255, 1)">void</span> list_splice_init(<span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">list,
</span><span style="color: rgba(0, 0, 255, 1)">struct</span> list_head *<span style="color: rgba(0, 0, 0, 1)">head)
{
</span><span style="color: rgba(0, 0, 255, 1)">if</span> (!<span style="color: rgba(0, 0, 0, 1)">list_empty(list)) {
__list_splice(list, head);
INIT_LIST_HEAD(list);
}
}

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_entry – get the struct for this entry
* @ptr:    the &amp;struct list_head pointer.
* @type:    the type of the struct this is embedded in.
* @member:    the name of the list_struct within the struct.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> list_entry(ptr, type, member) \<span style="color: rgba(0, 0, 0, 1)">
((type </span>*)((<span style="color: rgba(0, 0, 255, 1)">char</span> *)(ptr)-(unsigned <span style="color: rgba(0, 0, 255, 1)">long</span>)(&amp;((type *)<span style="color: rgba(128, 0, 128, 1)">0</span>)-&gt;<span style="color: rgba(0, 0, 0, 1)">member)))

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_for_each    -    iterate over a list
* @pos:    the &amp;struct list_head to use as a loop counter.
* @head:    the head for your list.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> list_for_each(pos, head) \
<span style="color: rgba(0, 0, 255, 1)">for</span> (pos = (head)-&gt;next; pos !=<span style="color: rgba(0, 0, 0, 1)"> (head); \
pos </span>= pos-&gt;<span style="color: rgba(0, 0, 0, 1)">next)
</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_for_each_prev    -    iterate over a list backwards
* @pos:    the &amp;struct list_head to use as a loop counter.
* @head:    the head for your list.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> list_for_each_prev(pos, head) \
<span style="color: rgba(0, 0, 255, 1)">for</span> (pos = (head)-&gt;prev; pos !=<span style="color: rgba(0, 0, 0, 1)"> (head); \
pos </span>= pos-&gt;<span style="color: rgba(0, 0, 0, 1)">prev)

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_for_each_safe    -    iterate over a list safe against removal of list entry
* @pos:    the &amp;struct list_head to use as a loop counter.
* @n:        another &amp;struct list_head to use as temporary storage
* @head:    the head for your list.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> list_for_each_safe(pos, n, head) \
<span style="color: rgba(0, 0, 255, 1)">for</span> (pos = (head)-&gt;next, n = pos-&gt;next; pos !=<span style="color: rgba(0, 0, 0, 1)"> (head); \
pos </span>= n, n = pos-&gt;<span style="color: rgba(0, 0, 0, 1)">next)

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_for_each_entry    -    iterate over list of given type
* @pos:    the type * to use as a loop counter.
* @head:    the head for your list.
* @member:    the name of the list_struct within the struct.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> list_for_each_entry(pos, head, member)                \
<span style="color: rgba(0, 0, 255, 1)">for</span> (pos = list_entry((head)-&gt;next, <span style="color: rgba(0, 0, 255, 1)">typeof</span>(*<span style="color: rgba(0, 0, 0, 1)">pos), member);    \
</span>&amp;pos-&gt;member !=<span style="color: rgba(0, 0, 0, 1)"> (head);                     \
pos </span>= list_entry(pos-&gt;member.next, <span style="color: rgba(0, 0, 255, 1)">typeof</span>(*<span style="color: rgba(0, 0, 0, 1)">pos), member))

</span><span style="color: rgba(0, 128, 0, 1)">/*</span><span style="color: rgba(0, 128, 0, 1)">*
* list_for_each_entry_safe – iterate over list of given type safe against removal of list entry
* @pos:    the type * to use as a loop counter.
* @n:        another type * to use as temporary storage
* @head:    the head for your list.
* @member:    the name of the list_struct within the struct.
</span><span style="color: rgba(0, 128, 0, 1)">*/</span>
<span style="color: rgba(0, 0, 255, 1)">#define</span> list_for_each_entry_safe(pos, n, head, member)            \
<span style="color: rgba(0, 0, 255, 1)">for</span> (pos = list_entry((head)-&gt;next, <span style="color: rgba(0, 0, 255, 1)">typeof</span>(*<span style="color: rgba(0, 0, 0, 1)">pos), member),    \
n </span>= list_entry(pos-&gt;member.next, <span style="color: rgba(0, 0, 255, 1)">typeof</span>(*<span style="color: rgba(0, 0, 0, 1)">pos), member);    \
</span>&amp;pos-&gt;member !=<span style="color: rgba(0, 0, 0, 1)"> (head);                     \
pos </span>= n, n = list_entry(n-&gt;member.next, <span style="color: rgba(0, 0, 255, 1)">typeof</span>(*<span style="color: rgba(0, 0, 0, 1)">n), member))

</span><span style="color: rgba(0, 0, 255, 1)">#endif</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>client</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>#include <span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">head.h</span><span style="color: rgba(128, 0, 0, 1)">"</span>

<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">任务： 负责接收消息。</span>
<span style="color: rgba(0, 0, 255, 1)">void</span> *routine(<span style="color: rgba(0, 0, 255, 1)">void</span> *arg) <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">arg = &amp;connfd</span>
<span style="color: rgba(0, 0, 0, 1)">{
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> sockfd = *(<span style="color: rgba(0, 0, 255, 1)">int</span> *<span style="color: rgba(0, 0, 0, 1)">)arg;
    
    </span><span style="color: rgba(0, 0, 255, 1)">char</span> buf[<span style="color: rgba(128, 0, 128, 1)">1024</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        bzero(buf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buf));
        recv(sockfd,buf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span>(buf),<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">%s</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">,buf);
    }
}

</span><span style="color: rgba(0, 0, 255, 1)">int</span> main(<span style="color: rgba(0, 0, 255, 1)">int</span> argc,<span style="color: rgba(0, 0, 255, 1)">char</span> *argv[]) <span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">./client 192.168.90.2 50001</span>
<span style="color: rgba(0, 0, 0, 1)">{
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">1. 创建一个未连接套接字</span>
    <span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)"> sockfd;
    sockfd </span>= socket(AF_INET,SOCK_STREAM,<span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2. 直接发起连接</span>
    <span style="color: rgba(0, 0, 255, 1)">struct</span><span style="color: rgba(0, 0, 0, 1)"> sockaddr_in srvaddr;
    socklen_t len </span>= <span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(srvaddr);
    bzero(</span>&amp;<span style="color: rgba(0, 0, 0, 1)">srvaddr,len);
    
    srvaddr.sin_family </span>= AF_INET;<span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">协议</span>
    srvaddr.sin_port = htons(atoi(argv[<span style="color: rgba(128, 0, 128, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">]));
    inet_pton(AF_INET,argv[</span><span style="color: rgba(128, 0, 128, 1)">1</span>],&amp;<span style="color: rgba(0, 0, 0, 1)">srvaddr.sin_addr);
    
    </span><span style="color: rgba(0, 0, 255, 1)">int</span> ret = connect(sockfd,(<span style="color: rgba(0, 0, 255, 1)">struct</span> sockaddr *)&amp;<span style="color: rgba(0, 0, 0, 1)">srvaddr,len);
    </span><span style="color: rgba(0, 0, 255, 1)">if</span>(ret == -<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
        printf(</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">connect error!\n</span><span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(0, 0, 0, 1)">);
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">2.5 创建线程</span>
<span style="color: rgba(0, 0, 0, 1)">    pthread_t tid;
    pthread_create(</span>&amp;tid,NULL,routine,(<span style="color: rgba(0, 0, 255, 1)">void</span> *)&amp;<span style="color: rgba(0, 0, 0, 1)">sockfd);
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">3. 不断发送数据给服务器</span>
    <span style="color: rgba(0, 0, 255, 1)">char</span> buf[<span style="color: rgba(128, 0, 128, 1)">1024</span><span style="color: rgba(0, 0, 0, 1)">];
    </span><span style="color: rgba(0, 0, 255, 1)">while</span>(<span style="color: rgba(128, 0, 128, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)
    {
        bzero(buf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buf));
        fgets(buf,</span><span style="color: rgba(0, 0, 255, 1)">sizeof</span><span style="color: rgba(0, 0, 0, 1)">(buf),stdin);
        send(sockfd,buf,strlen(buf),</span><span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">);

        </span><span style="color: rgba(0, 0, 255, 1)">if</span>(strncmp(buf,<span style="color: rgba(128, 0, 0, 1)">"</span><span style="color: rgba(128, 0, 0, 1)">quit</span><span style="color: rgba(128, 0, 0, 1)">"</span>,<span style="color: rgba(128, 0, 128, 1)">4</span>) == <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">)
        {
            </span><span style="color: rgba(0, 0, 255, 1)">break</span><span style="color: rgba(0, 0, 0, 1)">;
        }
    }
    
    </span><span style="color: rgba(0, 128, 0, 1)">//</span><span style="color: rgba(0, 128, 0, 1)">4. 挂断电话</span>
<span style="color: rgba(0, 0, 0, 1)">    close(sockfd);
    
    </span><span style="color: rgba(0, 0, 255, 1)">return</span> <span style="color: rgba(128, 0, 128, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">;
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>&nbsp;</p>
</div>
<div class="clear"></div>
<div id="blog_post_info_block"><div id="BlogPostCategory">
    分类: 
            <a href="https://www.cnblogs.com/zjlbk/category/1500694.html" target="_blank">嵌入式</a></div>


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(11398130,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
        <a id="green_channel_follow" onclick="follow(&#39;c6e9dd05-c375-4f18-a2f1-08d6e43e75b8&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/zjlbk/" target="_blank"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/20190703183942.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/zjlbk/">柚子皮max</a><br>
            <a href="https://home.cnblogs.com/u/zjlbk/followees/">关注 - 2</a><br>
            <a href="https://home.cnblogs.com/u/zjlbk/followers/">粉丝 - 10</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;c6e9dd05-c375-4f18-a2f1-08d6e43e75b8&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(11398130,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">0</span>
    </div>
    <div class="buryit" onclick="votePost(11398130,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>

<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/zjlbk/p/11378663.html" class="p_n_p_prefix">« </a> 上一篇：    <a href="https://www.cnblogs.com/zjlbk/p/11378663.html" title="发布于 2019-08-19 18:00">2019年8月19日星期一（网络编程 udp协议 非诸塞io 多路复用 网络超时接收 广播）</a>
    <br>
    <a href="https://www.cnblogs.com/zjlbk/p/11477675.html" class="p_n_p_prefix">» </a> 下一篇：    <a href="https://www.cnblogs.com/zjlbk/p/11477675.html" title="发布于 2019-09-06 19:16">2019年9月6日星期四（STM32开发环境配置）</a>

</div>
</div>
            </div>
            <div class="postDesc">posted @ 
<span id="post-date">2019-08-23 09:34</span>&nbsp;
<a href="https://www.cnblogs.com/zjlbk/">柚子皮max</a>&nbsp;
阅读(<span id="post_view_count">439</span>)&nbsp;
评论(<span id="post_comment_count">0</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=11398130" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(11398130);return false;">收藏</a>&nbsp;
<a href="javascript:void(0)" onclick="reportManager.report({ currentUserId: &#39;&#39;, targetType: &#39;blogPost&#39;, targetId: &#39;11398130&#39;, targetLink: &#39;https://www.cnblogs.com/zjlbk/p/11398130.html&#39;, title: &#39;基于Linux购票服务器&#39; })">举报</a></div>
        </div>
        
<script src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/highlight.min.js.下载" async="" onload="markdown_highlight()"></script>
<script>
    var allowComments = true, cb_blogId = 525257, cb_blogApp = 'zjlbk', cb_blogUserGuid = 'c6e9dd05-c375-4f18-a2f1-08d6e43e75b8';
    var cb_entryId = 11398130, cb_entryCreatedDate = '2019-08-23 09:34', cb_postType = 1;
    updatePostStats(
        [cb_entryId],
        function(id, count) { $("#post_view_count").text(count) },
        function(id, count) { $("#post_comment_count").text(count) })
    zoomManager.apply("#cnblogs_post_body img:not(.code_img_closed):not(.code_img_opened)");
</script>

        <a name="!comments"></a>
<div id="blog-comments-placeholder"></div>
<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/zjlbk/p/11398130.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/zjlbk/p/11398130.html#top">返回顶部</a></div>
    <div id="comment_form_container" style="visibility: visible;"><div class="login_tips">
    登录后才能查看或发表评论，立即 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return account.login(&#39;!comments&#39;);">登录</a> 或者
    <a href="https://www.cnblogs.com/">逛逛</a> 博客园首页
</div>
</div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"><a href="https://cloud.baidu.com/campaign/bccdiscount/index.html?track=cp:bokeyuan|pf:pc|pp:H-bokeyuan-21bccsanqi-neiyewenzilian|pu:21bccsanqi-neiyewenzilian|ci:21bcc|kw:10370321" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-百度智能云&#39;)">【推荐】百度智能云超值优惠：新用户首购云服务器1核1G低至69元/年</a><br><a href="http://www.uccpsoft.com/index.htm" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-ucancode&#39;)">【推荐】跨平台组态\工控\仿真\CAD 50万行C++源码全开放免费下载！</a><br><a href="https://www.aliyun.com/minisite/goods?taskCode=yds2021-09zy&amp;recordId=883117&amp;userCode=swh7dvlt" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-阿里云-cps&#39;)">【推荐】阿里云云大使特惠：新用户购ECS服务器1核2G最低价87元/年</a><br><a href="https://brands.cnblogs.com/huawei" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-华为专区&#39;)">【推荐】和开发者在一起：华为开发者社区，入驻博客园科技品牌专区</a><br><a href="https://www.cnblogs.com/cmt/p/15147135.html" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-众安保险&#39;)">【推广】园子与爱卡汽车爱宝险合作，随手就可以买一份的百万医疗保险</a><br></div>
    <div id="opt_under_post"></div>
    <div id="cnblogs_c1" class="under-post-card">
             <a onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;Pangle-C1&#39;)" target="_blank" rel="nofollow" href="https://c.gridsumdissector.com/r/?gid=gad_545_ph4hkwzt&amp;ck=32&amp;adk=442&amp;autorefresh=__AUTOREFRESH__">
                <img style="width: 300px; height: 250px;" src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/35695-20210817131346802-930113090.jpg" alt="" onload="gscmdImpress()">
             </a>
    </div>
    <div id="under_post_card1"><div class="under-post-card">
<b>编辑推荐：</b>
<br>

· <a href="https://www.cnblogs.com/zhujiqian/p/15312435.html" target="_blank"> 通过 Wireshark 抓包分析谈谈 DNS 域名解析的那些事儿</a>
    <br>
· <a href="https://www.cnblogs.com/eventhorizon/p/15316955.html" target="_blank">概述 .NET 6 ThreadPool 实现</a>
    <br>
· <a href="https://www.cnblogs.com/xuanyuan/p/15266447.html" target="_blank">现代操作系统管理内存，到底是分段还是分页？</a>
    <br>
· <a href="https://www.cnblogs.com/snailZz/p/15287774.html" target="_blank">源码解析 Grpc 拦截器 (C# 版本)</a>
    <br>
· <a href="https://www.cnblogs.com/xiaoxiaotank/p/15273093.html" target="_blank">理解ASP.NET Core - Host</a>
    <br>
</div></div>
    <div id="under_post_card2"><div class="itnews under-post-card">
    <b>最新新闻</b>：
    <br>
 ·          <a href="https://news.cnblogs.com/n/702783/" target="_blank">这届年轻人，换手机也需要理由了（2021-09-23 17:51）</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/702782/" target="_blank">谁在“追杀”瑞幸咖啡（2021-09-23 17:50）</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/702781/" target="_blank">叮咚买菜和每日优鲜不盈利，百果园和鲜丰水果还有希望吗？（2021-09-23 17:37）</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/702780/" target="_blank">抖音“防沉迷”，能有多大用？（2021-09-23 17:24）</a>
        <br>
 ·          <a href="https://news.cnblogs.com/n/702779/" target="_blank">年薪百万后，我花20万为游戏氪金，也查出了肝损伤（2021-09-23 17:12）</a>
        <br>
    » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
</div></div>
    <div id="HistoryToday" class="under-post-card"></div>
    <script type="text/javascript">
       var commentManager = new blogCommentManager();
       commentManager.renderComments(0);
       fixPostBody();
setTimeout(function() { incrementViewCount(cb_entryId); }, 50);       deliverT2();
       deliverC1C2();
       loadNewsAndKb();
LoadPostCategoriesTags(cb_blogId, cb_entryId);       LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
       GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
       loadOptUnderPost();
       GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div>

    </div>
</div>
            </div>
        </div>

        <div id="sideBar">
            <div id="sideBarMain">
                <div id="sidebar_news" class="newsItem">
<h3 class="catListTitle">公告</h3>

<div id="blog-news">
    <div style="width: 105px; height: 110px; margin-left: auto; margin-right: auto"><img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/o_psb.png" style="width: 100px; height: 100px">
</div>

<h2 style="text-align: center">柚子皮MAX</h2>

<br>
<img src="./基于Linux购票服务器 - 柚子皮max - 博客园_files/o_fgx.jpg" style="width: 100%">
<br>
    <div id="profile_block">
        昵称：
        <a href="https://home.cnblogs.com/u/zjlbk/">
            柚子皮max
        </a>
        <br>
        园龄：
        <a href="https://home.cnblogs.com/u/zjlbk/" title="入园时间：2019-05-30">
            2年3个月
        </a>
        <br>
        粉丝：
        <a href="https://home.cnblogs.com/u/zjlbk/followers/">
            10
        </a>
        <br>
        关注：
        <a href="https://home.cnblogs.com/u/zjlbk/followees/">
            2
        </a>
        <div id="p_b_follow">
<a href="javascript:void(0)" onclick="follow(&#39;c6e9dd05-c375-4f18-a2f1-08d6e43e75b8&#39;)">+加关注</a></div>
        <script>getFollowStatus('c6e9dd05-c375-4f18-a2f1-08d6e43e75b8');</script>
    </div>
</div></div>
<div id="sidebar_c3"></div>
                <div id="calendar"><div id="blog-calendar" style="">

<table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar" border="0">
    <tbody>
        <tr>
            <td colspan="7">
                <table class="CalTitle" cellspacing="0" border="0">
                    <tbody>
                        <tr>
                            <td class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2021/08/23&#39;); return false;">&lt;</a>
                            </td>
                            <td align="center">2021年9月</td>
                            <td align="right" class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2021/10/23&#39;); return false;">&gt;</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    <tr>
        <th class="CalDayHeader" align="center" abbr="日" scope="col">日</th>
        <th class="CalDayHeader" align="center" abbr="一" scope="col">一</th>
        <th class="CalDayHeader" align="center" abbr="二" scope="col">二</th>
        <th class="CalDayHeader" align="center" abbr="三" scope="col">三</th>
        <th class="CalDayHeader" align="center" abbr="四" scope="col">四</th>
        <th class="CalDayHeader" align="center" abbr="五" scope="col">五</th>
        <th class="CalDayHeader" align="center" abbr="六" scope="col">六</th>
    </tr>
            <tr>
                            <td class="CalOtherMonthDay" align="center">29</td>
                            <td class="CalOtherMonthDay" align="center">30</td>
                            <td class="CalOtherMonthDay" align="center">31</td>
                        <td class="" align="center">
                            1
                        </td>
                        <td class="" align="center">
                            2
                        </td>
                        <td class="" align="center">
                            3
                        </td>
                    <td class="CalWeekendDay" align="center">
                        4
                    </td>
            </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            5
                        </td>
                            <td class="" align="center">
                                6
                            </td>
                            <td class="" align="center">
                                7
                            </td>
                            <td class="" align="center">
                                8
                            </td>
                            <td class="" align="center">
                                9
                            </td>
                            <td class="" align="center">
                                10
                            </td>
                        <td class="CalWeekendDay" align="center">
                            11
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            12
                        </td>
                            <td class="" align="center">
                                13
                            </td>
                            <td class="" align="center">
                                14
                            </td>
                            <td class="" align="center">
                                15
                            </td>
                            <td class="" align="center">
                                16
                            </td>
                            <td class="" align="center">
                                17
                            </td>
                        <td class="CalWeekendDay" align="center">
                            18
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            19
                        </td>
                            <td class="" align="center">
                                20
                            </td>
                            <td class="" align="center">
                                21
                            </td>
                            <td class="" align="center">
                                22
                            </td>
                            <td class="CalTodayDay" align="center">
                                23
                            </td>
                            <td class="" align="center">
                                24
                            </td>
                        <td class="CalWeekendDay" align="center">
                            25
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            26
                        </td>
                            <td class="" align="center">
                                27
                            </td>
                            <td class="" align="center">
                                28
                            </td>
                            <td class="" align="center">
                                29
                            </td>
                            <td class="" align="center">
                                30
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                1
                            </td>
                        <td class="CalOtherMonthDay" align="center">
                            2
                        </td>
                </tr>
                <tr>
                        <td class="CalOtherMonthDay" align="center">
                            3
                        </td>
                            <td class="CalOtherMonthDay" align="center">
                                4
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                5
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                6
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                7
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                8
                            </td>
                        <td class="CalOtherMonthDay" align="center">
                            9
                        </td>
                </tr>
    </tbody>
</table></div></div>                
                <script>loadBlogDefaultCalendar();</script>
                <div id="leftcontentcontainer">
                    <!-- begin:SingleColumn -->
                    <div id="blog-sidecolumn"><!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle">搜索</h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk">
            </div>
            <div id="widget_my_google" class="div_my_zzk">
                <input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk">
            </div>
        </div>
    </div>
</div>

<!-- 常用链接 -->
<div id="sidebar_shortcut" class="sidebar-block">
<h3 class="catListTitle">
常用链接
</h3>
<ul>
    
<li><a href="https://www.cnblogs.com/zjlbk/p/" title="我的博客的随笔列表">我的随笔</a></li>
<li><a href="https://www.cnblogs.com/zjlbk/MyComments.html" title="我的发表过的评论列表">我的评论</a></li>
<li><a href="https://www.cnblogs.com/zjlbk/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li>
<li><a href="https://www.cnblogs.com/zjlbk/RecentComments.html" title="我的博客的评论列表">最新评论</a></li>
<li><a href="https://www.cnblogs.com/zjlbk/tag/" title="我的博客的标签列表">我的标签</a></li>

</ul>
</div>

<!-- 最新随笔 -->


<!-- 我的标签 -->
<div id="sidebar_toptags" class="sidebar-block">
<div class="catListTag">
    <h3 class="catListTitle">我的标签</h3>
    <ul>
                <li>
            <a href="https://www.cnblogs.com/zjlbk/tag/%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%AD%A6%E4%B9%A0/">嵌入式学习<span class="tag-count">(22)</span></a>
        </li>
    

    </ul>
</div>
</div>

<!-- 积分与排名 -->


<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">

    <div class="catListPostCategory">
        <h3 class="catListTitle">
            
随笔分类



        </h3>
        <ul>
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/zjlbk/category/1500694.html" rel="" target="">
    嵌入式(48)
</a>

                    
                </li>
                                        
        </ul>
    </div>    <div class="catListPostArchive">
        <h3 class="catListTitle">
            
随笔档案



        </h3>
        <ul>
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/zjlbk/archive/2019/09.html" rel="" target="">
    2019年9月(13)
</a>

                    
                </li>
                                            <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/zjlbk/archive/2019/08.html" rel="" target="">
    2019年8月(11)
</a>

                    
                </li>
                                            <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/zjlbk/archive/2019/07.html" rel="" target="">
    2019年7月(25)
</a>

                    
                </li>
                                        
        </ul>
    </div>    <div class="catListImageCategory">
        <h3 class="catListTitle">
            
相册



        </h3>
        <ul>
                <li data-category-list-item-visible="true" style="display: block">
                    
<a href="https://www.cnblogs.com/zjlbk/gallery/1521364.html" rel="nofollow noopener noreferrer" target="">
    yzp(2)
</a>

                    
                </li>
                                        
        </ul>
    </div></div>

<!-- 最新评论 -->
<div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap" class="RecentComment">
    <h3 class="catListTitle">最新评论</h3>
    <div class="RecentCommentBlock">
        <ul>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/zjlbk/p/11159968.html">1. Re:2019年7月9日星期二（C语言）</a></li>
                    <li class="recent_comment_body">@ 柚子皮max好的，知道了，谢谢...</li>
                    <li class="recent_comment_author">--廿柒</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/zjlbk/p/11159968.html">2. Re:2019年7月9日星期二（C语言）</a></li>
                    <li class="recent_comment_body">@ 廿柒如果求总的金额可以不用递归函数，可以用等差数列求和就可以int fun(int a){ int money=0; if(n&lt;1) return -1; if(n == 1) return 10...</li>
                    <li class="recent_comment_author">--柚子皮max</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/zjlbk/p/11159968.html">3. Re:2019年7月9日星期二（C语言）</a></li>
                    <li class="recent_comment_body">@ 柚子皮max我的意思是第n天求卡里总共有多少钱，笔记上没问题的...</li>
                    <li class="recent_comment_author">--廿柒</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/zjlbk/p/11159968.html">4. Re:2019年7月9日星期二（C语言）</a></li>
                    <li class="recent_comment_body">不好意思，money是等于10+get_money(n-1)，刚刚回复打错了，笔记上没有问题</li>
                    <li class="recent_comment_author">--柚子皮max</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/zjlbk/p/11159968.html">5. Re:2019年7月9日星期二（C语言）</a></li>
                    <li class="recent_comment_body">@ 柚子皮maxn是天数啊 n + get_money(n-1)累加不到前一天存的总钱数，应该这样。int get_money(int n){	int money;	if(n &lt; 1) return ...</li>
                    <li class="recent_comment_author">--廿柒</li>
        </ul>
    </div>
</div></div>


<!-- 阅读排行榜 -->
<div id="sidebar_topviewedposts" class="sidebar-block">
<div id="topview_posts_wrap">
    <h3 class="catListTitle">阅读排行榜</h3>
    <div id="TopViewPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/zjlbk/p/11359578.html">
                            1. linux线程池分析(1106)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/zjlbk/p/11574001.html">
                            2. 2019年9月23日星期一（STM32 spi接口 rc522）(925)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/zjlbk/p/11227726.html">
                            3. 2019年7月22日星期一(6818开发板)(847)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/zjlbk/p/11552397.html">
                            4. 2019年9月19日星期四（STM32 rtc实时时钟 i2c协议）(713)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/zjlbk/p/11502555.html">
                            5. 2019年9月9日星期一（STM32 内部时钟 中断）(624)
                        </a>
                    </li>
        </ul>
    </div>
</div></div>

<!-- 评论排行榜 -->
<div id="sidebar_topcommentedposts" class="sidebar-block"><div id="topfeedback_posts_wrap">
    <h3 class="catListTitle">评论排行榜</h3>
    <div id="TopFeedbackPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/zjlbk/p/11159968.html">
                            1. 2019年7月9日星期二（C语言）(7)
                        </a>
                    </li>
        </ul>
    </div>
</div></div>

<!-- 推荐排行榜 -->
<div id="sidebar_topdiggedposts" class="sidebar-block">
<div id="topdigg_posts_wrap">
    <div class="catListView">
        <h3 class="catListTitle">推荐排行榜</h3>
        <div id="TopDiggPostsBlock">
            <ul style="word-break: break-all">
                        <li>
                            <a href="https://www.cnblogs.com/zjlbk/p/11203127.html">
                                1. 2019年7月17日星期三(linux基础)(1)
                            </a>
                        </li>
            </ul>
        </div>
    </div>
</div></div></div>
                    <script>loadBlogSideColumn();</script>
                    <!-- end:  SingleColumn -->
                </div>
            </div>
        </div>
        <div class="clear"></div>
    </div>
    <div class="clear"></div>
    <div id="footer">
        <!--done-->
Copyright © 2021 柚子皮max
<br><span id="poweredby">Powered by .NET 6 on Kubernetes</span>

    </div>
</div>

    

    <input type="hidden" id="antiforgery_token" value="CfDJ8NACB8VE9qlHm6Ujjqxvg5B4YOEoixo161W_rymZpf_yyJRUs2XRSgs65Hdhrejfh8oUIbMRZGn4XuWRrNZwmlbrUUhVlpz3942yHmyXzGk57tj_Tumf2zLon8hYw1py0D_rMb5GN4GNMDVBVMTg0CI">


</body></html>